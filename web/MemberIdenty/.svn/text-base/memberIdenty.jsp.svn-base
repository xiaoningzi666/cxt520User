<%@ page language="java" contentType="text/html; charset=utf-8" pageEncoding="utf-8"%>
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">	
<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
<link rel="stylesheet" href="../../css/mui.min.css">
<link rel="stylesheet" type="text/css" href="../../css/mobileSelect.css">
<link rel="stylesheet" href="../../css/myiconfont.css" />
<link rel="stylesheet" href="../../css/app.css" />
<link rel="stylesheet" href="../../css/mui.picker.min.css" />
<link rel="stylesheet" href="../../css/animate.min.css" />
<title>会员认证</title>
</head>
<body>
	<header class="mui-bar mui-bar-nav mymemberIdenty_header">
	    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
	    <h1 class="mui-title">会员认证</h1>
	    <a  class="mui-pull-right aaa red animated bounceIn" id="safebtn">保存</a>
	</header>
	<div class="mui-content memberIdenty">
		<article class="red">
		*温馨提示：我们将依照相关法律要求严格保密您的隐私信息*
		</article>
		<section class="memberIdenty_items">
			<ul class="memberIdenty_itemL">
				<li class="memberIdenty_item">
					<div class="left">姓&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;名</div>
					<div class="right mIdty"><input type="text" name="name" placeholder="请填写真实姓名"/></div>
					<div class="clear"></div>
				</li>
				<li class="memberIdenty_item">
					<div class="left">性&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;别</div>
					<div class="right mIdty">
						 <div class="mui-input-row mui-radio man mui-left">
							<label>男</label>
							<input name="radio1" type="radio" value="1" checked="checked"/>
						</div>
						<div class="mui-input-row mui-radio man mui-left">
							<label>女</label>
							<input name="radio1" type="radio" value="2"/>
						</div>
					</div>
				</li>
				<li class="memberIdenty_item">
					<div class="left">身&nbsp;份&nbsp;证</div>
					<div class="right mIdty"><input type="text" name="idCardNo"  placeholder="请填写身份证号码" maxlength="18"/></div>
					<div class="clear"></div>
				</li>
				<li class="memberIdenty_item">
					<div class="left">-&nbsp;省&nbsp;-&nbsp;市</div>
					<div class="right mIdty mui-navigate-right">
						<input type="text" name="" id="trigger" value="" placeholder="请输入地区"/>
						<input type="hidden" name="region" id="trigger1" value="" placeholder="请输入地区"/>
					</div>
					<div class="clear"></div>
				</li>
				<li class="memberIdenty_item">
					<div class="left">详细地址</div>
					<div class="right mIdty">
						<input type="text" placeholder="街道、门牌号等" id="detailAdr"/>
					</div>
				</li>
			</ul>
			<ul class="memberIdenty_itemL">
				<li class="memberIdenty_item">
					<div class="left">品牌车系</div>
					<div class="right mIdty">
						<input type="hidden" value="" id="carModel"/>
						<a href="carBand.jsp" class="mui-navigate-right mui-pull-right"><i class="mui-pull-right myupdate" id="carSeries" style="margin-right: 2.3rem;">请选择车辆品牌</i></a>
					</div>
					<div class="clear"></div>
				</li>
				<li class="memberIdenty_item">
					<div class="left">&nbsp;车&nbsp;牌&nbsp;号</div>
					<div class="right CarID mIdty">
						<input type="text"  id="bandItem" placeholder="豫B" value="豫B" style="width: 3rem;"/>
						<input type="text"  name="carnum" placeholder="请填写完整的车牌号码" value="" maxlength="5"/>
					</div>
					<div class="clear"></div>
				</li>
				<li class="memberIdenty_item">
					<div class="left">购车日期</div>
					<div class="right mIdty">
						<a href="#about" class="mui-navigate-right mui-pull-right" id="BuyCarDate_btn" data-options='{"type":"date"}'>
						<i class="mui-pull-right update myupdate" id="BuyCarDate_text" style="margin-right: 2.3rem;">请选择爱车购车日期</i></a>
					</div>
					<div class="clear"></div>
				</li>
			</ul>
			<ul class="memberIdenty_itemL">
				<li class="memberIdenty_item">
					<div class="left">推  荐  人</div>
					<div class="right mIdty"><input type="text" name="refereeCode"  placeholder="请填写推荐人手机号" maxlength="11"/></div>
					<div class="clear"></div>
				</li>
			</ul>
			<div class="vp_items" style="padding-left: 10px;">
				<div class="p3">
	    			<span class="checkbox">
	    				<input type="checkbox" id="checkbox"/>
	    				<img src="../../images/nochecked.png"></i>
	    			</span>
	    			<a href="520notice.html">我已阅读《<i class="red">520会员须知</i>》</a>
	    		</div>
			</div>
		</section>
	</div>
<div class="short_wrap animated "  id="shortItem1" >
	<p><span id="shortText1" class="blue shortText">京</span><span class="mui-pull-right blue" id="confirmBtn1">确认</span></p>
	<div class="short short1">
		<a class="checked1">京</a><a>津</a><a>沪</a><a>渝</a><a>冀</a><a>豫</a><a>云</a><a>辽</a><a>黑</a>
		<a>湘</a><a>皖</a><a>鲁</a><a>新</a><a>苏</a><a>浙</a><a>赣</a><a>桂</a><a>甘</a>
		<a>晋</a><a>蒙</a><a>陕</a><a>吉</a><a>闽</a><a>贵</a><a>粤</a><a>青</a><a>藏</a>
		<a>澳</a><a>港</a><a>黔</a><a>鄂</a><a>台</a><a>琼</a><a>宁</a><a>川</a>
	</div>
</div>
<div class="short_wrap" id="shortItem2">
	<p><span id="shortText2" class="blue shortText">A</span><span class="mui-pull-right blue" id="confirmBtn2">确认</span></p>
	<div class="short short2" >
		<a class="checked2">A</a><a>B</a><a>C</a><a>D</a><a>E</a><a>F</a><a>G</a><a>H</a><a>I</a>
		<a>R</a><a>Q</a><a>P</a><a>O</a><a>N</a><a>M</a><a>L</a><a>K</a><a>J</a>
		<a>S</a><a>T</a><a>U</a><a>V</a><a>W</a><a>X</a><a>Y</a><a>Z</a>
	</div>
</div>
	
</body>
<script src="../../js/mui.min.js"></script>
<script src="../../js/mui.picker.min.js"></script>
<script src="../../js/jquery-1.7.2.min.js" ></script>
<script src="../../js/common.js" ></script>
<script src="../../js/mobileSelect.js"></script>
<script>
	mui.init();
	(function($){
		$.init();
		var result = $('#BuyCarDate_text')[0];
		var btn = $('#BuyCarDate_btn')[0];
		btn.addEventListener('tap', function() {
				var optionsJson = this.getAttribute('data-options') || '{}';
				var options = JSON.parse(optionsJson);
				var id = this.getAttribute('id');
				var picker = new $.DtPicker(options);
				picker.show(function(rs) {
					result.innerText = rs.text;
					picker.dispose();
				});
				
			}, false);
	})(mui);
	var re=/^[\u4e00-\u9fa5]{1}[A-Z]{1}[A-Z_0-9]{5}$/;
	var storage = window.localStorage;
	var weekdayArr=[];
	var codeFlag='';
	var regionData = [];
	$.ajax({
		type:"get",
		url:apiUrl+"/configration/getstations",
		data:{
			"pageSize":10,
			"pageNum":1
		},
		dataType:"json",
		success:function(data){
			if(data.return_code=="SUCCESS"){
				$.each(data.pageInfo.list, function(index,item) {
					weekdayArr[index] = {"id":item.region,"name":item.name}
				});
			}
			var mobileSelect1 = new MobileSelect({
		    trigger: '#trigger', 
		    title: '地区选择',  
		    wheels: [
		                {data:weekdayArr}
		            ],
		    callback:function(indexArr, data){
		        //console.log($('#trigger1').val(data[0].id));
		        $('#trigger').val(data[0].name)
		        $('#trigger1').val(data[0].id)
		    } 
			});
		}
	});
	if(storage['carSeriesName']&&storage['carItemName']){
		$('#carSeries').text(storage['carSeriesName']+' '+storage['carItemName'])
	}
	$(function(){
		var str='';
		$('#bandItem').click(function(){
			$('#shortItem1').fadeToggle();
			$('#shortItem2').hide();
		})
		$('.short1 a').click(function(){
			str=$(this).text();
			$('.shortText').text($(this).text())
			$('.short a').removeClass('checked1')
			$(this).addClass('checked1');
		})
		$('.short2 a').click(function(){
			str+=$(this).text();
			$('.shortText').text($(this).text())
			$('.short a').removeClass('checked2')
			$(this).addClass('checked2');
		})
		$('#confirmBtn1').click(function(){
			str=$('.short1 .checked1').text()
			$('#bandItem').val(str)
			$('#shortItem1').hide();
			$('#shortItem2').show();
		})
		$('#confirmBtn2').click(function(){
			str+=$('.short1 .checked2').text()
			$('#shortItem2').hide();
			$('#bandItem').val(str)
		})
		
		$('#carNo').val($('#bandItem').val()+' '+$('input[name=carnum]').val())
		
	})
	
	$('.checkbox').click(function(){
		if($('#checkbox').is(":checked")){
			$(this).find("img").attr("src","../../images/checked.png")
		}else{
			$(this).find("img").attr("src","../../images/nochecked.png")
		}
	})
	storage['Pname']=$('input[name=name]').val()
	$('#safebtn').click(function(){
		if($('#checkbox').is(":checked")){
			var str='';
			str=$('#bandItem').val()+' '+$('input[name=carnum]').val();
				if(!checkCard($('input[name=idCardNo]').val(),$('input[name=name]').val())){
			}
			else if(str.search(re)==-1){
				alert(re)
				mui.toast("车牌号无效")
			}
			else if($('input[name=idCardNo]').val().substr(-2,1)%2!=$('input[name=radio1]:checked').val()%2){
				mui.toast("您选择的性别与身份证的性别不一致")
			}else if(!$('#trigger1').val()||!$('#detailAdr').val()){
				mui.toast("地址不能为空")
			}else if(!$('#BuyCarDate_text').text()){
				mui.toast("购车日期不能为空")
			}else if(!$('input[name=idCardNo]').val()){
				mui.toast("品牌车系不能为空")
			}else{
				$.ajax({
					type:"post",
					url:apiUrl+"/member/memberident",
					data:{
						"userId":storage['getUserId'],
						"sign":storage['getSign'],
						"name":$('input[name=name]').val(),
						"sex":$('input[name=radio1]:checked').val(),
						"idCardNo":$('input[name=idCardNo]').val(),
						"region":$('#trigger1').val(),
						"carModel":storage['carModel'],
						"carNo":str,
						"carPurchaseDate":$('#BuyCarDate_text').text(),
						"address":$('#detailAdr').val(),
						"refereeCode":$('input[name=refereeCode]').val()
						
					},
					dataType:"json",
					success:function(data){
						if(data.return_code=="SUCCESS"){
							mui.toast('发送成功')
							window.location.assign("../../person_msg/personCenter.html")
						}else{
							mui.toast(data.return_msg)
						}
					}
				});
			}
		}else{
			mui.toast("请确认您已阅读520会员须知")
		}
		
	})
</script>
</html>